(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54073,e=>{"use strict";var t=e.i(1720);async function r(){let e=(0,t.createClient)(),{data:{user:r}}=await e.auth.getUser();if(!r)return null;let{data:i,error:a}=await e.from("profiles").select("*").eq("id",r.id).maybeSingle();return a?(console.error("Error fetching profile:",a),null):i}async function i(e=null){let r=(0,t.createClient)(),{data:{user:a}}=await r.auth.getUser();if(!a)return{error:"Not authenticated"};let{data:n,error:s}=await r.from("profiles").insert({id:a.id,username:e||a.email?.split("@")[0],elo:1e3,wins:0,losses:0}).select().single();return s?(console.error("Error creating profile:",s),{error:s}):{data:n}}async function a(){let e=await r();if(e)return e;let{data:t,error:a}=await i();return a?null:t}async function n(e){let r=(0,t.createClient)(),{data:{user:i}}=await r.auth.getUser();if(!i)return{error:"Not authenticated"};let{data:a,error:n}=await r.from("profiles").update(e).eq("id",i.id).select().single();return n?(console.error("Error updating profile:",n),{error:n}):{data:a}}async function s(e){let r=(0,t.createClient)(),{data:{user:i}}=await r.auth.getUser();if(!i)return{error:"Not authenticated"};let{data:a,error:n}=await r.from("picks").insert({user_id:i.id,game_id:e.gameId,home_team:e.homeTeam,away_team:e.awayTeam,pick_type:e.pickType,pick_value:e.pickValue,odds:e.odds,game_date:e.gameDate,is_locked:!1,result:"pending"}).select().single();return n?(console.error("Error saving pick:",n),{error:n}):{data:a}}async function l(){let e=(0,t.createClient)(),{data:{user:r}}=await e.auth.getUser();if(!r)return[];let{data:i,error:a}=await e.from("picks").select("*").eq("user_id",r.id).order("created_at",{ascending:!1});return a?(console.error("Error fetching picks:",a),[]):i}async function o(){let e=(0,t.createClient)(),{data:{user:r}}=await e.auth.getUser();if(!r)return[];let{data:i,error:a}=await e.from("picks").select("*").eq("user_id",r.id).eq("result","pending").order("created_at",{ascending:!1});return a?(console.error("Error fetching pending picks:",a),[]):i}async function c(){let e=(0,t.createClient)(),{data:{user:r}}=await e.auth.getUser();if(!r)return[];let{data:i,error:a}=await e.from("picks").select("*").eq("user_id",r.id).eq("is_locked",!0).order("created_at",{ascending:!1});return a?(console.error("Error fetching locked picks:",a),[]):i}async function d(e){let r=(0,t.createClient)(),{data:{user:i}}=await r.auth.getUser();if(!i)return{error:"Not authenticated"};let{data:a,error:n}=await r.from("picks").update({is_locked:!0}).eq("id",e).eq("user_id",i.id).select().single();return n?(console.error("Error locking pick:",n),{error:n}):{data:a}}async function u(e){let r=(0,t.createClient)(),{data:{user:i}}=await r.auth.getUser();if(!i)return{error:"Not authenticated"};let{error:a}=await r.from("picks").delete().eq("id",e).eq("user_id",i.id).eq("is_locked",!1);return a?(console.error("Error deleting pick:",a),{error:a}):{success:!0}}async function f(e,i){var a,n;let s,l,o=(0,t.createClient)(),{data:{user:c}}=await o.auth.getUser();if(!c)return{error:"Not authenticated"};let{data:d,error:u}=await o.from("picks").select("*").eq("id",e).eq("user_id",c.id).single();if(u||!d)return{error:"Pick not found"};if("pending"!==d.result)return{error:"Pick already validated",pick:d};if("push"===i){let{data:t}=await o.from("picks").update({result:"push"}).eq("id",e).select().single();return{pick:t,profile:await r(),eloChange:0}}let f=await r();if(!f)return{error:"Profile not found"};let g="win"===i,{newElo:p,change:h}=(a=f.elo,l=1+(.5-((n=d.odds)>0?100/(n+100):Math.abs(n)/(Math.abs(n)+100))),{newElo:Math.max(0,a+(s=g?Math.max(10,Math.min(50,s=Math.round(25*l))):Math.max(-30,Math.min(-10,s=-Math.round(25*(1-(l-1)*.5)))))),change:s}),{error:k}=await o.from("picks").update({result:i}).eq("id",e);if(k)return{error:"Failed to update pick result"};let w={elo:p,wins:g?f.wins+1:f.wins,losses:g?f.losses:f.losses+1},{data:m,error:_}=await o.from("profiles").update(w).eq("id",c.id).select().single();if(_)return{error:"Failed to update profile"};let{data:y}=await o.from("picks").select("*").eq("id",e).single();return{pick:y,profile:m,eloChange:h}}async function g(){let e=(0,t.createClient)(),{data:{user:r}}=await e.auth.getUser();if(!r)return[];let{data:i,error:a}=await e.from("picks").select("*").eq("user_id",r.id).eq("is_locked",!0).eq("result","pending").order("game_date",{ascending:!0});return a?(console.error("Error fetching picks to validate:",a),[]):i}async function p(e,r){let i=(0,t.createClient)(),{data:{user:a}}=await i.auth.getUser();if(!a)return!1;let{data:n,error:s}=await i.from("picks").select("id").eq("user_id",a.id).eq("game_id",e).eq("pick_type",r).single();return!s&&!!n}async function h(e,r){let i=(0,t.createClient)(),{data:{user:a}}=await i.auth.getUser();if(!a)return null;let{data:n,error:s}=await i.from("picks").select("*").eq("user_id",a.id).eq("game_id",e).eq("pick_type",r).single();return s?null:n}e.s(["deletePick",()=>u,"getLockedPicks",()=>c,"getOrCreateProfile",()=>a,"getPendingPicks",()=>o,"getPick",()=>h,"getPicksToValidate",()=>g,"getUserPicks",()=>l,"getUserProfile",()=>r,"hasPick",()=>p,"lockPick",()=>d,"savePick",()=>s,"updateUserProfile",()=>n,"validateAndUpdatePick",()=>f])},82018,e=>{"use strict";var t=e.i(56042),r=e.i(47004),i=e.i(55685),a=e.i(1720),n=e.i(54073);function s(){let e=(0,i.useRouter)(),s=(0,a.createClient)();return(0,r.useEffect)(()=>{(async()=>{let{searchParams:t}=new URL(window.location.href),r=t.get("code"),i=t.get("next")||"/dashboard";if(r){let{error:t}=await s.auth.exchangeCodeForSession(r);t?(console.error("Auth error:",t),e.push("/login?error=auth_callback_error")):(await (0,n.getOrCreateProfile)(),e.push(i))}else{let{data:{session:t}}=await s.auth.getSession();t?(await (0,n.getOrCreateProfile)(),e.push(i)):e.push("/login")}})()},[e,s]),(0,t.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"#0A1128",color:"#fff"},children:(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsx)("h2",{children:"Verifying Login..."}),(0,t.jsx)("p",{children:"Please wait while we redirect you."})]})})}e.s(["default",()=>s])}]);