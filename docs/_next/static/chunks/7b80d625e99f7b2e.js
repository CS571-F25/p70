(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,10951,e=>{"use strict";var a=e.i(32900),s=e.i(87098),r=e.i(81451),l=e.i(86448);function t(){let[e,t]=(0,s.useState)(!1),[i,n]=(0,s.useState)(""),[o,m]=(0,s.useState)(""),[u,c]=(0,s.useState)(""),[d,h]=(0,s.useState)(!1),[p,f]=(0,s.useState)(null),g=(0,l.useRouter)(),x=(0,r.createClient)(),b=async a=>{a.preventDefault(),h(!0),f(null);try{if(e){let{data:e}=await x.from("profiles").select("username, email").or(`username.eq.${o},email.eq.${i}`);if(e&&e.length>0){let a=e.find(e=>e.username===o),s=e.find(e=>e.email===i);if(a)throw Error("Username already taken");if(s)throw Error("Email already registered")}let{error:a}=await x.auth.signUp({email:i,password:u,options:{data:{username:o,full_name:o,display_name:o},emailRedirectTo:`${location.origin}/auth/callback`}});if(a)throw a;g.push("/dashboard"),g.refresh()}else{let e=i;if(!i.includes("@")){let{data:a,error:s}=await x.from("profiles").select("email").eq("username",i).single();if(s||!a)throw Error("Invalid username or password");e=a.email}let{error:a}=await x.auth.signInWithPassword({email:e,password:u});if(a)throw a;g.push("/dashboard"),g.refresh()}}catch(e){f(e.message)}finally{h(!1)}};return(0,a.jsxs)("div",{className:"auth-container",children:[(0,a.jsx)("h2",{className:"auth-title",children:e?"Create Account":"Welcome Back"}),p&&(0,a.jsx)("div",{className:"error-message",children:p}),(0,a.jsxs)("form",{onSubmit:b,className:"auth-form",children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",htmlFor:"email",children:e?"Email Address":"Email or Username"}),(0,a.jsx)("input",{id:"email",type:e?"email":"text",className:"form-input",value:i,onChange:e=>n(e.target.value),placeholder:e?"you@example.com":"Email or Username",required:!0})]}),e&&(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",htmlFor:"username",children:"Username"}),(0,a.jsx)("input",{id:"username",type:"text",className:"form-input",value:o,onChange:e=>m(e.target.value),placeholder:"Choose a username",required:!0})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",htmlFor:"password",children:"Password"}),(0,a.jsx)("input",{id:"password",type:"password",className:"form-input",value:u,onChange:e=>c(e.target.value),placeholder:"••••••••",minLength:6,required:!0})]}),(0,a.jsx)("button",{type:"submit",className:"auth-button",disabled:d,children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"spinner"}),"Processing..."]}):e?"Sign Up":"Sign In"})]}),(0,a.jsxs)("div",{className:"auth-toggle",children:[e?"Already have an account?":"Don't have an account?",(0,a.jsx)("button",{type:"button",className:"toggle-link",onClick:()=>t(!e),children:e?"Sign In":"Sign Up"})]})]})}e.s(["default",()=>t])}]);