(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26822,e=>{"use strict";var a=e.i(58142);async function t(){let e=(0,a.createClient)(),{data:{user:t}}=await e.auth.getUser();if(!t)return null;let{data:s,error:i}=await e.from("profiles").select("*").eq("id",t.id).maybeSingle();return i?(console.error("Error fetching profile:",i),null):s}async function s(e=null){let t=(0,a.createClient)(),{data:{user:i}}=await t.auth.getUser();if(!i)return{error:"Not authenticated"};let{data:r,error:n}=await t.from("profiles").insert({id:i.id,username:e||i.email?.split("@")[0],elo:1e3,wins:0,losses:0}).select().single();return n?(console.error("Error creating profile:",n),{error:n}):{data:r}}async function i(){let e=await t();if(e)return e;let{data:a,error:i}=await s();return i?null:a}async function r(e){let t=(0,a.createClient)(),{data:{user:s}}=await t.auth.getUser();if(!s)return{error:"Not authenticated"};let{data:i,error:r}=await t.from("profiles").update(e).eq("id",s.id).select().single();return r?(console.error("Error updating profile:",r),{error:r}):{data:i}}async function n(e){let t=(0,a.createClient)(),{data:{user:s}}=await t.auth.getUser();if(!s)return{error:"Not authenticated"};let{data:i,error:r}=await t.from("picks").insert({user_id:s.id,game_id:e.gameId,home_team:e.homeTeam,away_team:e.awayTeam,pick_type:e.pickType,pick_value:e.pickValue,odds:e.odds,game_date:e.gameDate,is_locked:!1,result:"pending"}).select().single();return r?(console.error("Error saving pick:",r),{error:r}):{data:i}}async function l(){let e=(0,a.createClient)(),{data:{user:t}}=await e.auth.getUser();if(!t)return[];let{data:s,error:i}=await e.from("picks").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});return i?(console.error("Error fetching picks:",i),[]):s}async function c(){let e=(0,a.createClient)(),{data:{user:t}}=await e.auth.getUser();if(!t)return[];let{data:s,error:i}=await e.from("picks").select("*").eq("user_id",t.id).eq("result","pending").order("created_at",{ascending:!1});return i?(console.error("Error fetching pending picks:",i),[]):s}async function d(){let e=(0,a.createClient)(),{data:{user:t}}=await e.auth.getUser();if(!t)return[];let{data:s,error:i}=await e.from("picks").select("*").eq("user_id",t.id).eq("is_locked",!0).order("created_at",{ascending:!1});return i?(console.error("Error fetching locked picks:",i),[]):s}async function o(e){let t=(0,a.createClient)(),{data:{user:s}}=await t.auth.getUser();if(!s)return{error:"Not authenticated"};let{data:i,error:r}=await t.from("picks").update({is_locked:!0}).eq("id",e).eq("user_id",s.id).select().single();return r?(console.error("Error locking pick:",r),{error:r}):{data:i}}async function m(e){let t=(0,a.createClient)(),{data:{user:s}}=await t.auth.getUser();if(!s)return{error:"Not authenticated"};let{error:i}=await t.from("picks").delete().eq("id",e).eq("user_id",s.id).eq("is_locked",!1);return i?(console.error("Error deleting pick:",i),{error:i}):{success:!0}}async function u(e,s){var i,r;let n,l,c=(0,a.createClient)(),{data:{user:d}}=await c.auth.getUser();if(!d)return{error:"Not authenticated"};let{data:o,error:m}=await c.from("picks").select("*").eq("id",e).eq("user_id",d.id).single();if(m||!o)return{error:"Pick not found"};if("pending"!==o.result)return{error:"Pick already validated",pick:o};if("push"===s){let{data:a}=await c.from("picks").update({result:"push"}).eq("id",e).select().single();return{pick:a,profile:await t(),eloChange:0}}let u=await t();if(!u)return{error:"Profile not found"};let h="win"===s,{newElo:p,change:g}=(i=u.elo,l=1+(.5-((r=o.odds)>0?100/(r+100):Math.abs(r)/(Math.abs(r)+100))),{newElo:Math.max(0,i+(n=h?Math.max(10,Math.min(50,n=Math.round(25*l))):Math.max(-30,Math.min(-10,n=-Math.round(25*(1-(l-1)*.5)))))),change:n}),{error:f}=await c.from("picks").update({result:s}).eq("id",e);if(f)return{error:"Failed to update pick result"};let k={elo:p,wins:h?u.wins+1:u.wins,losses:h?u.losses:u.losses+1},{data:x,error:N}=await c.from("profiles").update(k).eq("id",d.id).select().single();if(N)return{error:"Failed to update profile"};let{data:j}=await c.from("picks").select("*").eq("id",e).single();return{pick:j,profile:x,eloChange:g}}async function h(){let e=(0,a.createClient)(),{data:{user:t}}=await e.auth.getUser();if(!t)return[];let{data:s,error:i}=await e.from("picks").select("*").eq("user_id",t.id).eq("is_locked",!0).eq("result","pending").order("game_date",{ascending:!0});return i?(console.error("Error fetching picks to validate:",i),[]):s}async function p(e,t){let s=(0,a.createClient)(),{data:{user:i}}=await s.auth.getUser();if(!i)return!1;let{data:r,error:n}=await s.from("picks").select("id").eq("user_id",i.id).eq("game_id",e).eq("pick_type",t).single();return!n&&!!r}async function g(e,t){let s=(0,a.createClient)(),{data:{user:i}}=await s.auth.getUser();if(!i)return null;let{data:r,error:n}=await s.from("picks").select("*").eq("user_id",i.id).eq("game_id",e).eq("pick_type",t).single();return n?null:r}e.s(["deletePick",()=>m,"getLockedPicks",()=>d,"getOrCreateProfile",()=>i,"getPendingPicks",()=>c,"getPick",()=>g,"getPicksToValidate",()=>h,"getUserPicks",()=>l,"getUserProfile",()=>t,"hasPick",()=>p,"lockPick",()=>o,"savePick",()=>n,"updateUserProfile",()=>r,"validateAndUpdatePick",()=>u])},55888,e=>{"use strict";var a=e.i(56731),t=e.i(28317);e.i(36356);let s={async getNBAGames(){try{let e=await fetch("https://api.the-odds-api.com/v4/sports/basketball_nba/odds?apiKey=75d06b5288579c5fc0a01b9b95c477bc&regions=us&markets=h2h,spreads,totals&oddsFormat=american&dateFormat=iso");if(!e.ok)throw Error(`API Error: ${e.status} ${e.statusText}`);let a=e.headers.get("x-requests-remaining"),t=e.headers.get("x-requests-used");console.log(`ğŸ“Š API Quota - Remaining: ${a}, Used: ${t}`);let s=await e.json();return console.log(`ğŸ€ NBA Games fetched: ${s.length}`),s}catch(e){throw console.error("Error fetching NBA games:",e),e}}};var i=e.i(58142),r=e.i(26822);e.s(["default",0,function(){let[e,n]=(0,t.useState)([]),[l,c]=(0,t.useState)(!0),[d,o]=(0,t.useState)(null),[m,u]=(0,t.useState)(null),[h,p]=(0,t.useState)(!0),[g,f]=(0,t.useState)(null),[k,x]=(0,t.useState)([]),[N,j]=(0,t.useState)(!1),[w,v]=(0,t.useState)("");(0,t.useEffect)(()=>{let e=(0,i.createClient)();!async function(){let{data:{user:a}}=await e.auth.getUser();u(a),p(!1),a&&await (0,r.getOrCreateProfile)()}();let{data:{subscription:a}}=e.auth.onAuthStateChange((e,a)=>{u(a?.user??null)});return()=>a.unsubscribe()},[]),(0,t.useEffect)(()=>{!async function(){try{c(!0),o(null);let e=await s.getNBAGames();n(e),c(!1)}catch(e){console.error("Error fetching games:",e),o(e.message),c(!1)}}()},[]),(0,t.useEffect)(()=>{!async function(){if(!m)return x([]);x([...await (0,r.getPendingPicks)(),...await (0,r.getLockedPicks)()])}()},[m]);let y=e=>{v(e),j(!0),setTimeout(()=>j(!1),3e3)},b=async(e,a,t,s,i=null)=>{if(!m)return void y("ğŸ” Please log in to make predictions!");if(new Date(e.commence_time)<=new Date)return void y("âŒ Cannot predict on games that have already started!");if(await (0,r.hasPick)(e.id,a)){let t=await (0,r.getPick)(e.id,a);t&&t.is_locked?y("ğŸ”’ You already have a LOCKED prediction for this game!"):y("âš ï¸ You already have a prediction for this bet type!");return}f({eventId:e.id,homeTeam:e.home_team,awayTeam:e.away_team,betType:a,selection:t,odds:s,point:i,commenceTime:e.commence_time})},_=async()=>{if(g){if(!m)return void y("ğŸ” Please log in to make predictions!");try{let{data:e,error:a}=await (0,r.savePick)({gameId:g.eventId,homeTeam:g.homeTeam,awayTeam:g.awayTeam,pickType:g.betType,pickValue:g.selection,odds:g.odds,gameDate:g.commenceTime});if(a){y("âŒ Failed to save prediction"),console.error(a);return}x([...k,e]),y("âœ… Prediction saved successfully!"),f(null)}catch(e){y("âŒ Failed to save prediction"),console.error(e)}}},P=(e,a,t)=>!!g&&g.eventId===e&&g.betType===a&&g.selection===t,C=(e,a)=>k.some(t=>t.game_id===e&&t.pick_type===a),q=(e,a)=>{if(!e)return null;let t=e.markets.find(e=>e.key===a);return t?t.outcomes:null};return l||h?(0,a.jsx)("div",{className:"predictions-page",children:(0,a.jsxs)("div",{className:"loading-container",children:[(0,a.jsx)("div",{className:"loading-spinner"}),(0,a.jsx)("h2",{children:"Loading NBA Games..."})]})}):d?(0,a.jsx)("div",{className:"predictions-page",children:(0,a.jsxs)("div",{className:"error-container",children:[(0,a.jsx)("h1",{children:"âš ï¸ Error Loading Games"}),(0,a.jsx)("p",{className:"error-message",children:d}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"retry-btn",children:"Retry"})]})}):0===e.length?(0,a.jsx)("div",{className:"predictions-page",children:(0,a.jsxs)("div",{className:"no-games-container",children:[(0,a.jsx)("h1",{children:"ğŸ€ No NBA Games Available"}),(0,a.jsx)("p",{children:"Check back later for upcoming games!"})]})}):(0,a.jsxs)("div",{className:"predictions-page",children:[(0,a.jsxs)("div",{className:"predictions-header",children:[(0,a.jsx)("h1",{className:"page-title",children:"ğŸ€ NBA Predictions"}),(0,a.jsxs)("div",{className:"header-info",children:[(0,a.jsxs)("p",{className:"games-count",children:[e.length," Games Available"]}),!m&&(0,a.jsxs)("span",{className:"login-prompt",children:[(0,a.jsx)("a",{href:"/login",children:"Log in"})," to save predictions"]}),m&&k.length>0&&(0,a.jsxs)("span",{className:"predictions-badge",children:[k.length," Active Pick",1!==k.length?"s":""]})]})]}),g&&(0,a.jsxs)("div",{className:"confirmation-buttons",children:[(0,a.jsx)("div",{className:"confirmation-info",children:(0,a.jsxs)("p",{children:[(0,a.jsxs)("strong",{children:["moneyline"===g.betType?"Moneyline":"spread"===g.betType?"Spread":"Total",":"]})," ",g.selection,g.point&&` (${g.point>0?"+":""}${g.point})`," ","@ ",g.odds>0?"+":"",g.odds]})}),(0,a.jsx)("button",{className:"confirm-btn",onClick:_,children:"âœ“ Confirm Pick"}),(0,a.jsx)("button",{className:"clear-btn",onClick:()=>{f(null)},children:"âœ• Clear"})]}),N&&(0,a.jsx)("div",{className:"toast-notification",children:w}),(0,a.jsx)("div",{className:"games-container",children:e.map(e=>{let t=e.bookmakers&&0!==e.bookmakers.length?e.bookmakers.find(e=>"draftkings"===e.key)||e.bookmakers[0]:null,s=q(t,"h2h"),i=q(t,"spreads"),r=q(t,"totals"),n=new Date(e.commence_time),l=n.toDateString()===new Date().toDateString(),c=new Date(e.commence_time)<=new Date;return(0,a.jsxs)("div",{className:`game-card ${c?"game-started":""}`,children:[(0,a.jsxs)("div",{className:"game-header",children:[(0,a.jsxs)("div",{className:"game-time",children:[(0,a.jsx)("span",{className:"date",children:n.toLocaleDateString()}),(0,a.jsx)("span",{className:"time",children:n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),l&&(0,a.jsx)("span",{className:"today-badge",children:"TODAY"}),c&&(0,a.jsx)("span",{className:"started-badge",children:"STARTED"})]}),t&&(0,a.jsx)("div",{className:"bookmaker-badge",children:t.title})]}),(0,a.jsxs)("div",{className:"teams-section",children:[(0,a.jsxs)("div",{className:"team",children:[(0,a.jsx)("span",{className:"team-name",children:e.away_team}),(0,a.jsx)("span",{className:"team-label",children:"AWAY"})]}),(0,a.jsx)("div",{className:"vs-divider",children:"@"}),(0,a.jsxs)("div",{className:"team",children:[(0,a.jsx)("span",{className:"team-name",children:e.home_team}),(0,a.jsx)("span",{className:"team-label",children:"HOME"})]})]}),(0,a.jsxs)("div",{className:"markets-section",children:[s&&(0,a.jsxs)("div",{className:"market-box",children:[(0,a.jsx)("h4",{className:"market-title",children:"Moneyline"}),(0,a.jsx)("div",{className:"odds-grid",children:s.map(t=>{let s=P(e.id,"moneyline",t.name),i=C(e.id,"moneyline"),r=c||i&&!s;return(0,a.jsxs)("button",{className:`odds-btn ${s?"selected":""} ${i?"locked":""} ${r?"disabled":""}`,onClick:()=>b(e,"moneyline",t.name,t.price),disabled:r,children:[(0,a.jsx)("span",{className:"odds-team",children:t.name}),(0,a.jsxs)("span",{className:"odds-value",children:[t.price>0?"+":"",t.price]}),i&&(0,a.jsx)("span",{className:"checkmark",children:"âœ“"})]},t.name)})})]}),i&&(0,a.jsxs)("div",{className:"market-box",children:[(0,a.jsx)("h4",{className:"market-title",children:"Spread"}),(0,a.jsx)("div",{className:"odds-grid",children:i.map(t=>{let s=P(e.id,"spread",t.name),i=C(e.id,"spread"),r=c||i&&!s;return(0,a.jsxs)("button",{className:`odds-btn ${s?"selected":""} ${i?"locked":""} ${r?"disabled":""}`,onClick:()=>b(e,"spread",t.name,t.price,t.point),disabled:r,children:[(0,a.jsx)("span",{className:"odds-team",children:t.name}),(0,a.jsxs)("span",{className:"odds-value",children:[t.point>0?"+":"",t.point," (",t.price>0?"+":"",t.price,")"]}),i&&(0,a.jsx)("span",{className:"checkmark",children:"âœ“"})]},t.name)})})]}),r&&(0,a.jsxs)("div",{className:"market-box",children:[(0,a.jsx)("h4",{className:"market-title",children:"Total Points"}),(0,a.jsx)("div",{className:"odds-grid",children:r.map(t=>{let s=P(e.id,"total",t.name),i=C(e.id,"total"),r=c||i&&!s;return(0,a.jsxs)("button",{className:`odds-btn ${s?"selected":""} ${i?"locked":""} ${r?"disabled":""}`,onClick:()=>b(e,"total",t.name,t.price,t.point),disabled:r,children:[(0,a.jsx)("span",{className:"odds-team",children:t.name}),(0,a.jsxs)("span",{className:"odds-value",children:[t.point," (",t.price>0?"+":"",t.price,")"]}),i&&(0,a.jsx)("span",{className:"checkmark",children:"âœ“"})]},t.name)})})]})]})]},e.id)})})]})}],55888)}]);