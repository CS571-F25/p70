(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54073,e=>{"use strict";var a=e.i(1720);async function s(){let e=(0,a.createClient)(),{data:{user:s}}=await e.auth.getUser();if(!s)return null;let{data:t,error:i}=await e.from("profiles").select("*").eq("id",s.id).maybeSingle();return i?(console.error("Error fetching profile:",i),null):t}async function t(e=null){let s=(0,a.createClient)(),{data:{user:i}}=await s.auth.getUser();if(!i)return{error:"Not authenticated"};let{data:r,error:l}=await s.from("profiles").insert({id:i.id,username:e||i.email?.split("@")[0],elo:1e3,wins:0,losses:0}).select().single();return l?(console.error("Error creating profile:",l),{error:l}):{data:r}}async function i(){let e=await s();if(e)return e;let{data:a,error:i}=await t();return i?null:a}async function r(e){let s=(0,a.createClient)(),{data:{user:t}}=await s.auth.getUser();if(!t)return{error:"Not authenticated"};let{data:i,error:r}=await s.from("profiles").update(e).eq("id",t.id).select().single();return r?(console.error("Error updating profile:",r),{error:r}):{data:i}}async function l(e){let s=(0,a.createClient)(),{data:{user:t}}=await s.auth.getUser();if(!t)return{error:"Not authenticated"};let{data:i,error:r}=await s.from("picks").insert({user_id:t.id,game_id:e.gameId,home_team:e.homeTeam,away_team:e.awayTeam,pick_type:e.pickType,pick_value:e.pickValue,odds:e.odds,game_date:e.gameDate,is_locked:!1,result:"pending"}).select().single();return r?(console.error("Error saving pick:",r),{error:r}):{data:i}}async function n(){let e=(0,a.createClient)(),{data:{user:s}}=await e.auth.getUser();if(!s)return[];let{data:t,error:i}=await e.from("picks").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});return i?(console.error("Error fetching picks:",i),[]):t}async function c(){let e=(0,a.createClient)(),{data:{user:s}}=await e.auth.getUser();if(!s)return[];let{data:t,error:i}=await e.from("picks").select("*").eq("user_id",s.id).eq("result","pending").order("created_at",{ascending:!1});return i?(console.error("Error fetching pending picks:",i),[]):t}async function o(){let e=(0,a.createClient)(),{data:{user:s}}=await e.auth.getUser();if(!s)return[];let{data:t,error:i}=await e.from("picks").select("*").eq("user_id",s.id).eq("is_locked",!0).order("created_at",{ascending:!1});return i?(console.error("Error fetching locked picks:",i),[]):t}async function d(e){let s=(0,a.createClient)(),{data:{user:t}}=await s.auth.getUser();if(!t)return{error:"Not authenticated"};let{data:i,error:r}=await s.from("picks").update({is_locked:!0}).eq("id",e).eq("user_id",t.id).select().single();return r?(console.error("Error locking pick:",r),{error:r}):{data:i}}async function u(e){let s=(0,a.createClient)(),{data:{user:t}}=await s.auth.getUser();if(!t)return{error:"Not authenticated"};let{error:i}=await s.from("picks").delete().eq("id",e).eq("user_id",t.id).eq("is_locked",!1);return i?(console.error("Error deleting pick:",i),{error:i}):{success:!0}}async function m(e,t){var i,r;let l,n,c=(0,a.createClient)(),{data:{user:o}}=await c.auth.getUser();if(!o)return{error:"Not authenticated"};let{data:d,error:u}=await c.from("picks").select("*").eq("id",e).eq("user_id",o.id).single();if(u||!d)return{error:"Pick not found"};if("pending"!==d.result)return{error:"Pick already validated",pick:d};if("push"===t){let{data:a}=await c.from("picks").update({result:"push"}).eq("id",e).select().single();return{pick:a,profile:await s(),eloChange:0}}let m=await s();if(!m)return{error:"Profile not found"};let p="win"===t,{newElo:h,change:f}=(i=m.elo,n=1+(.5-((r=d.odds)>0?100/(r+100):Math.abs(r)/(Math.abs(r)+100))),{newElo:Math.max(0,i+(l=p?Math.max(10,Math.min(50,l=Math.round(25*n))):Math.max(-30,Math.min(-10,l=-Math.round(25*(1-(n-1)*.5)))))),change:l}),{error:g}=await c.from("picks").update({result:t}).eq("id",e);if(g)return{error:"Failed to update pick result"};let x={elo:h,wins:p?m.wins+1:m.wins,losses:p?m.losses:m.losses+1},{data:j,error:N}=await c.from("profiles").update(x).eq("id",o.id).select().single();if(N)return{error:"Failed to update profile"};let{data:k}=await c.from("picks").select("*").eq("id",e).single();return{pick:k,profile:j,eloChange:f}}async function p(){let e=(0,a.createClient)(),{data:{user:s}}=await e.auth.getUser();if(!s)return[];let{data:t,error:i}=await e.from("picks").select("*").eq("user_id",s.id).eq("is_locked",!0).eq("result","pending").order("game_date",{ascending:!0});return i?(console.error("Error fetching picks to validate:",i),[]):t}async function h(e,s){let t=(0,a.createClient)(),{data:{user:i}}=await t.auth.getUser();if(!i)return!1;let{data:r,error:l}=await t.from("picks").select("id").eq("user_id",i.id).eq("game_id",e).eq("pick_type",s).single();return!l&&!!r}async function f(e,s){let t=(0,a.createClient)(),{data:{user:i}}=await t.auth.getUser();if(!i)return null;let{data:r,error:l}=await t.from("picks").select("*").eq("user_id",i.id).eq("game_id",e).eq("pick_type",s).single();return l?null:r}e.s(["deletePick",()=>u,"getLockedPicks",()=>o,"getOrCreateProfile",()=>i,"getPendingPicks",()=>c,"getPick",()=>f,"getPicksToValidate",()=>p,"getUserPicks",()=>n,"getUserProfile",()=>s,"hasPick",()=>h,"lockPick",()=>d,"savePick",()=>l,"updateUserProfile",()=>r,"validateAndUpdatePick",()=>m])},61392,e=>{"use strict";var a=e.i(56042),s=e.i(47004),t=e.i(1720),i=e.i(54073),r=e.i(89070);function l(){var e;let[l,n]=(0,s.useState)(null),[c,o]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0),[m,p]=(0,s.useState)(!1),[h,f]=(0,s.useState)(""),[g,x]=(0,s.useState)(!1),[j,N]=(0,s.useState)({type:"",text:""}),k=(0,t.createClient)();(0,s.useEffect)(()=>{(async()=>{let{data:{user:e}}=await k.auth.getUser();if(n(e),e){let e=await (0,i.getUserProfile)();o(e),f(e?.username||"")}u(!1)})()},[]);let v=async()=>{if(!h.trim())return void N({type:"error",text:"Username cannot be empty"});x(!0),N({type:"",text:""});let e=await (0,i.updateUserProfile)({username:h.trim()});e?(o(e),p(!1),N({type:"success",text:"Username updated successfully!"})):N({type:"error",text:"Failed to update username. Try again."}),x(!1)},w=async()=>{await k.auth.signOut(),window.location.href="/login"};if(d)return(0,a.jsx)("div",{className:"profile-page",children:(0,a.jsxs)("div",{className:"profile-loading",children:[(0,a.jsx)("div",{className:"loading-spinner"}),(0,a.jsx)("p",{children:"Loading profile..."})]})});if(!l)return(0,a.jsx)("div",{className:"profile-page",children:(0,a.jsxs)("div",{className:"profile-login-prompt",children:[(0,a.jsx)("h2",{children:"ðŸ”’ Sign In Required"}),(0,a.jsx)("p",{children:"Please sign in to view your profile."}),(0,a.jsx)(r.default,{href:"/login",className:"login-button",children:"Sign In"})]})});let y=(e=c?.elo||1e3)>=2e3?{title:"Legend",emoji:"ðŸ‘‘"}:e>=1700?{title:"Expert",emoji:"ðŸ†"}:e>=1400?{title:"Pro",emoji:"â­"}:e>=1100?{title:"Rising Star",emoji:"ðŸ“ˆ"}:{title:"Rookie",emoji:"ðŸŒ±"};return(0,a.jsx)("div",{className:"profile-page",children:(0,a.jsxs)("div",{className:"profile-container",children:[(0,a.jsxs)("div",{className:"profile-header",children:[(0,a.jsx)("div",{className:"profile-avatar",children:(c?.username||l.email)?.[0]?.toUpperCase()||"?"}),(0,a.jsxs)("div",{className:"profile-info",children:[m?(0,a.jsxs)("div",{className:"edit-username",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>f(e.target.value),placeholder:"Enter username",className:"username-input",maxLength:20}),(0,a.jsxs)("div",{className:"edit-buttons",children:[(0,a.jsx)("button",{onClick:v,disabled:g,className:"save-btn",children:g?"Saving...":"Save"}),(0,a.jsx)("button",{onClick:()=>{p(!1),f(c?.username||"")},className:"cancel-btn",children:"Cancel"})]})]}):(0,a.jsxs)("div",{className:"username-display",children:[(0,a.jsx)("h1",{children:c?.username||"Set Username"}),(0,a.jsx)("button",{onClick:()=>p(!0),className:"edit-btn",children:"âœï¸ Edit"})]}),(0,a.jsx)("p",{className:"profile-email",children:l.email})]})]}),j.text&&(0,a.jsx)("div",{className:`profile-message ${j.type}`,children:j.text}),(0,a.jsxs)("div",{className:"profile-stats",children:[(0,a.jsxs)("div",{className:"stat-card elo-card",children:[(0,a.jsx)("span",{className:"stat-emoji",children:y.emoji}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-value",children:c?.elo||1e3}),(0,a.jsx)("span",{className:"stat-label",children:"ELO Rating"}),(0,a.jsx)("span",{className:"stat-rank",children:y.title})]})]}),(0,a.jsxs)("div",{className:"stat-card wins-card",children:[(0,a.jsx)("span",{className:"stat-emoji",children:"âœ…"}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-value",children:c?.wins||0}),(0,a.jsx)("span",{className:"stat-label",children:"Wins"})]})]}),(0,a.jsxs)("div",{className:"stat-card losses-card",children:[(0,a.jsx)("span",{className:"stat-emoji",children:"âŒ"}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsx)("span",{className:"stat-value",children:c?.losses||0}),(0,a.jsx)("span",{className:"stat-label",children:"Losses"})]})]}),(0,a.jsxs)("div",{className:"stat-card winrate-card",children:[(0,a.jsx)("span",{className:"stat-emoji",children:"ðŸ“Š"}),(0,a.jsxs)("div",{className:"stat-content",children:[(0,a.jsxs)("span",{className:"stat-value",children:[(()=>{if(!c)return 0;let e=c.wins+c.losses;return 0===e?0:(c.wins/e*100).toFixed(1)})(),"%"]}),(0,a.jsx)("span",{className:"stat-label",children:"Win Rate"})]})]})]}),(0,a.jsxs)("div",{className:"elo-progress-section",children:[(0,a.jsx)("h3",{children:"ELO Progress"}),(0,a.jsxs)("div",{className:"elo-progress-bar",children:[(0,a.jsxs)("div",{className:"elo-tiers",children:[(0,a.jsx)("span",{className:c?.elo<1100?"active":"",children:"Rookie"}),(0,a.jsx)("span",{className:c?.elo>=1100&&c?.elo<1400?"active":"",children:"Rising Star"}),(0,a.jsx)("span",{className:c?.elo>=1400&&c?.elo<1700?"active":"",children:"Pro"}),(0,a.jsx)("span",{className:c?.elo>=1700&&c?.elo<2e3?"active":"",children:"Expert"}),(0,a.jsx)("span",{className:c?.elo>=2e3?"active":"",children:"Legend"})]}),(0,a.jsxs)("div",{className:"progress-track",children:[(0,a.jsx)("div",{className:"progress-fill",style:{width:`${Math.min((c?.elo||1e3)/2500*100,100)}%`}}),(0,a.jsx)("div",{className:"progress-marker",style:{left:`${Math.min((c?.elo||1e3)/2500*100,100)}%`}})]})]})]}),(0,a.jsxs)("div",{className:"profile-links",children:[(0,a.jsx)(r.default,{href:"/predictions",className:"profile-link predictions-link",children:"ðŸ€ Make Predictions"}),(0,a.jsx)(r.default,{href:"/dashboard",className:"profile-link dashboard-link",children:"ðŸ“Š View Dashboard"})]}),(0,a.jsx)("button",{onClick:w,className:"signout-button",children:"Sign Out"}),(0,a.jsxs)("div",{className:"account-info",children:[(0,a.jsx)("h3",{children:"Account Information"}),(0,a.jsxs)("div",{className:"info-row",children:[(0,a.jsx)("span",{className:"info-label",children:"Email"}),(0,a.jsx)("span",{className:"info-value",children:l.email})]}),(0,a.jsxs)("div",{className:"info-row",children:[(0,a.jsx)("span",{className:"info-label",children:"Member Since"}),(0,a.jsx)("span",{className:"info-value",children:c?.created_at?new Date(c.created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"N/A"})]}),(0,a.jsxs)("div",{className:"info-row",children:[(0,a.jsx)("span",{className:"info-label",children:"User ID"}),(0,a.jsxs)("span",{className:"info-value user-id",children:[l.id.slice(0,8),"..."]})]})]})]})})}e.s(["default",()=>l])}]);